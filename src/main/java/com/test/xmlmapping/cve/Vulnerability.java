package com.test.xmlmapping.cve;

import java.time.LocalDateTime;
import java.util.Date;
import java.util.List;

import com.thoughtworks.xstream.annotations.XStreamAlias;
import com.thoughtworks.xstream.annotations.XStreamAsAttribute;
import com.thoughtworks.xstream.annotations.XStreamConverter;
import com.thoughtworks.xstream.annotations.XStreamImplicit;
import com.thoughtworks.xstream.converters.extended.ToAttributedValueConverter;


@XStreamAlias("entry")
public class Vulnerability {

	@XStreamAlias("id")
	@XStreamAsAttribute
	private String cve;
	
	@XStreamAlias("summary")
	private String description;
	
	@XStreamAlias("published-datetime")
	private LocalDateTime publishedDate;
	
	@XStreamAlias("last-modified-datetime")
	private LocalDateTime lastModifiedDate;
	
	
	@XStreamAlias("cwe")
	@XStreamAsAttribute
	private Cwe cwe;
	
	@XStreamAlias("vulnerable-software-list")
	private ProductVulnerable vulProduct;
	
	@XStreamImplicit(itemFieldName = "references")
	private List<ReferenceVulnerability> vulReferences;

	@XStreamAlias("cvss")
	private BaseMetrics scoringSystem;
	
	@Override
	public String toString() {
		return "\n Vulnerability [\n cve=" + cve + ",\n CWE = " + cwe.id + " \n description=" + description + ", \n publishedDate=" + publishedDate
				+ ", \n lastModifiedDate=" + lastModifiedDate + ", \n references :   "+ vulReferences + " "
						+ " \n ==> scoringSystem : " + scoringSystem + " "
								+ " \n ==> vulProduct : " + vulProduct + "]";
	}
	
	//@XStreamConverter(value = ToAttributedValueConverter.class, strings= {"cwe"})
	@XStreamAlias("cwe")
	public class Cwe{
		
		@XStreamAsAttribute
		private String id;

		public String getId() {
			return id;
		}

		public void setId(String id) {
			this.id = id;
		}
		
		
	}
}


